# Архитектурное решение v3: Проект "Контентная воронка"

## 1. Философия и цели

- **Итеративность:** Разработка короткими циклами «шаг → метрики → шаг».
- **Фокус на MVP:** Минимально жизнеспособный продукт для проверки гипотез на реальном рынке.
- **Эксперт-центричность:** "Галерея экспертов" как центральный элемент для привлечения и удержания внимания.
- **Экономика внимания:** Вознаграждение пользователей за вовлеченность ("звезды"), а не немедленные продажи.
- **Короткие смыслы:** Упор на микро-контент (карточки, цитаты, выжимки) для быстрой навигации по большому объему материалов.
- **Регулярность:** Создание ритма вовлечения через автоматизированные форматы (например, еженедельные дайджесты).

## 2. Общая архитектура системы (MVP)

Для MVP архитектура будет упрощена, чтобы сфокусироваться на ключевых гипотезах.

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Telegram      │    │   API Gateway    │    │   Каналы TG     │
│   Mini App      │◄──►│   (монолит v0)   │◄──►│ (источник)    │
│   (React/Vue)   │    │                  │    │                 │
└─────────────────┘    └──────────────────┘    └─────────────────┘
                             │
                             ▼
     ┌─────────────────────────────────────────────────────────┐
     │                  Монолитный Backend (Node.js/Python)      │
     │ ┌─────────────┐  ┌─────────────┐ ┌─────────────────┐  │
     │  │  User Mgmt  │  │  Content M. │  │  Gamification   │  │
     │  │ (Профили)   │  │ (Карточки)  │  │ (Звезды)        │  │
     │  └─────────────┘  └─────────────┘  └─────────────────┘  │
     └─────────────────────────────────────────────────────────┘
                             │
                             ▼
     ┌─────────────────────────────────────────────────┐
     │                    Базы данных v0                       │
     │ ┌─────────────┐               ┌─────────────────┐  │
     │  │ PostgreSQL  │               │     Redis       │  │
     │  │ (все данные)│               │   (кеш/очереди) │  │
     │  └─────────────┘               └─────────────────┘  │
     └─────────────────────────────────────────────────┘
```

## 3. Компоненты архитектуры (MVP)

### 3.1. Frontend (Telegram Mini App)
- **Технологии:** React/Vue.js, TypeScript, Zustand/Redux, Tailwind CSS.
- **Ключевые экраны MVP:**
    - **"Я-профиль":** Отображение звезд, уровня, прогресса и полученных регалий.
    - **"Лента выжимок":** Основной экран с вертикальной прокруткой карточек контента.
    - **"Галерея экспертов":** Список экспертов с возможностью перехода к их карточкам.

### 3.2. Backend (Монолит v0)
- **Технологии:** Node.js (NestJS) или Python (FastAPI).
- **Модули MVP:**
    - **User Management:** Регистрация/аутентификация через Telegram, управление профилем.
    - **Content Management:** CRUD для карточек, выжимок, цитат и материалов экспертов.
    - **Gamification:** Логика начисления звезд за события (прочтение, оценка, реферал) и витрина для их траты.
    - **Referral System:** Генерация уникальных ссылок и отслеживание приглашений.
    - **Digest Engine:** Модуль для автоматического создания еженедельных дайджестов.

### 3.3. Базы данных (MVP)
- **PostgreSQL:** Единая база для хранения пользователей, контента, звезд, регалий, реферальных связей.
- **Redis:** Для кеширования профилей, сессий и организации очередей (например, для рассылки дайджестов).

## 4. Контент-машина (MVP)

- **Вход:** Видео/аудио записи (интервью, доклады).
- **Процесс:**
    1.  **Транскрибация:** Автоматическая (внешний сервис) или ручная.
    2.  **Отбор тезисов:** Редактор вручную отбирает 5-7 ключевых тезисов и 2 "вишенки-цитаты".
    3.  **Создание карточки:** Вёрстка карточки по шаблону.
    4.  **Публикация:** После ручного одобрения карточка появляется в ленте.
- **Ритм:** 10-15 карточек в неделю + 1 еженедельный дайджест.

## 5. План реализации (14 дней)

- **Дни 1-3:** Фиксация скоупа MVP, утверждение событийной схемы для аналитики, отбор 20 единиц контента для пилота.
- **Дни 4-7:** Создание 20 карточек, шаблона дайджеста и базовой "Галереи экспертов".
- **Дни 8-10:** Реализация логики начисления звезд и базовой реферальной системы.
- **Дни 11-14:** Внутренний тест с фокус-группой, сбор первых метрик и обратной связи.

## 6. Гипотезы и метрики для проверки

- **H1 (Глубина):** Карточки-выжимки увеличивают глубину сессии. **Метрика:** ≥3 карточки/сессию у ≥60% новых пользователей.
- **H2 (Удержание):** Профиль с регалиями повышает удержание. **Метрика:** D7 retention ≥25%.
- **H3 (Конверсия):** Галерея экспертов повышает интерес к контенту. **Метрика:** CTR на кнопку "Хочу больше" ≥20%.
- **H4 (Возвраты):** Дайджест увеличивает возвращаемость. **Метрика:** Uplift в D7/D14 у подписчиков дайджеста ≥15%.
- **H5 (Привлечение):** Реферальная программа эффективна. **Метрика:** ≥20% новых пользователей приходят по инвайтам, k-factor ≥0.2.