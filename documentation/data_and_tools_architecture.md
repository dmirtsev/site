# Архитектура данных и инструментов управления

## 1. Сущности базы данных (Таблицы)

-   **`users`**: Пользователи (id, telegram_id, name, level, stars_balance).
-   **`experts`**: **Справочник** экспертов (id, name, photo_url, bio, specialization).
-   **`tags`**: **Справочник** тем/тегов (id, name).
-   **`content_sources`**: Хранилище метаданных об исходных материалах (id, source_type, path, author_id, expert_id).
-   **`content_items`**: **Основная таблица контента.** Производные продукты (id, source_id, type: T1-T4, A1-A4..., content, status: draft/approved).
-   **`funnels`**: Конструктор воронок (id, name).
-   **`funnel_steps`**: Шаги воронок, определяющие последовательность показа `content_items` (id, funnel_id, item_id, platform, delay).
-   **`user_progress`**: История взаимодействий пользователя (id, user_id, item_id, action: view/like/save).

## 2. Инструменты управления (Административная панель)

Для управления всеми сущностями, справочниками и контентом рекомендуется использовать готовый **Headless CMS** (например, **Strapi** или **Directus**). Это позволит быстро создать мощную и удобную административную панель без необходимости писать ее с нуля.

### 2.1. Управление справочниками

-   **Интерфейс:** Админ-панель предоставит простые формы для добавления, редактирования и удаления **экспертов** и **тегов**.
-   **Процесс:** Контент-менеджер сможет легко заполнять эти справочники, которые затем будут использоваться в других разделах (например, при выборе эксперта для нового контента).

### 2.2. Инструмент для Контент-менеджера

Рабочий процесс по созданию контента будет выглядеть следующим образом в рамках той же админ-панели:

1.  **Загрузка источника:** Менеджер заходит в раздел "Источники", загружает видео/аудио и заполняет метаданные (выбирает эксперта и теги из выпадающих списков).
2.  **Запуск "Контент-машины":** Нажимает кнопку **"Начать обработку"**. Система автоматически генерирует черновики производного контента (`content_items`).
3.  **Редактирование и утверждение:** В разделе "Производный контент" менеджер видит список сгенерированных карточек. Он может их отредактировать и перевести из статуса "черновик" в "готово к публикации".
4.  **Конструктор воронок:** В разделе "Воронки" менеджер визуально (drag-and-drop) собирает последовательность из утвержденных `content_items`, настраивая для каждого шага канал показа (Telegram, Mini App) и задержку.

**Визуализация структуры админ-панели:**
```
+--------------------------------------------------+
| Admin Panel (на базе Strapi/Directus)            |
+--------------------------------------------------+
| Меню:                                            |
| > Справочники                                    |
|   - Эксперты                                     |
|   - Теги                                         |
| > Контент                                        |
|   - Источники (исходные видео/аудио)             |
|   - Производные продукты (карточки, заметки)     |
| > Воронки внимания                               |
|   - Конструктор воронок                          |
| > Пользователи                                   |
+--------------------------------------------------+